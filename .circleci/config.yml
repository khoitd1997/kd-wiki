version: 2.0
jobs:
  build:
    docker:
      - image: fedora:latest
    steps:
      - checkout
      - run:
          name: Install mdbook
          command: |
            dnf install -y git libxcrypt-compat curl file @development-tools
            git clone https://github.com/Homebrew/brew ~/.linuxbrew/Homebrew
            mkdir ~/.linuxbrew/bin
            ln -s ~/.linuxbrew/Homebrew/bin/brew ~/.linuxbrew/bin
            eval $(~/.linuxbrew/bin/brew shellenv)
            brew install mdbook

      - run:
          name: Build book
          command: |
            eval $(~/.linuxbrew/bin/brew shellenv)
            rm -rf docs/*
            mdbook build --dest-dir docs
